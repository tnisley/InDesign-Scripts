//ScriptName: SelectNewVehicles//Athor: Trystan Nisley/*	Finds vehicle descriptions that were added to the current ad	and makes a duplicate of the text to the left of the page. 	Makes findingvehicles that need added to the website effortless.*/// Get adID and store in regular expression// adID is six digit number in document namemyDocument = app.activeDocument;var myName = myDocument.name;var adID = myName.match(/\d\d\d\d\d\d/g);var myRegExp= new RegExp(adID, "g");// Set units to picas// Necessary for placing text boxmyDocument.viewPreferences.verticalMeasurementUnits = MeasurementUnits.PICAS;myDocument.viewPreferences.horizontalMeasurementUnits = MeasurementUnits.PICAS;//Get Document Heightvar height = myDocument.pages[0].bounds[2];var myStories = myDocument.stories; 	// Get text from all storiesvar myString;var newVehicleText = "";var matches = 0;//Search all text stories for a new ad. Add new ad to a temporary stringfor (var i= 0; i < myStories.length; i++)	{	// Search all stories for the ad ID	if (myStories[i].contents.match(myRegExp))	{		try		{			++matches;			myString = myStories[i].contents;     // Get Contents of the story			newVehicleText += myString + "\n\n";  // Add story text to string holding all the text.		}		catch(err){continue;};	}	} // Alert user if no new ads were found.if (matches == 0)		alert("No new vehicles were found.");		//Error: text found but couldn't be copied.else if (newVehicleText.length == 0 )	alert("Error finding new vehicles.");//New Vehicles foundelse{	//Create text box to hold new ads and place the new vehicles text in it	var myTextBox = myDocument.pages[0].textFrames.add({geometricBounds:[0, -18, height, -1]});	myTextBox.contents = newVehicleText;	//Format Text in text box	myTextBox.parentStory.paragraphs.everyItem().applyParagraphStyle(myDocument.paragraphStyles[0], true);	myTextBox.parentStory.paragraphs.everyItem().pointSize = 12;	myTextBox.parentStory.paragraphs.everyItem().justification = Justification.CENTER_ALIGN;	myTextBox.parentStory.paragraphs.everyItem().leading = 12;}