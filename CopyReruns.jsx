//ScriptName: CopyReruns//Athor: Trystan Nisley/*  Finds ad IDs from previous ads and copies them to the clipboard.	Is used to auto renew ads online. Alerts user to number of ads found.*/// Get adID of new ads and store in regular expression// Ad ID is 6 digits in filename.myDocument = app.activeDocument;var myName = myDocument.name;var adID = myName.match(/\d\d\d\d\d\d/g);var currentAdId= new RegExp(adID, "g");// Get text of all storiesvar myStories = myDocument.stories;var patternMatch;			//Regex for the adID of vehiclesvar renewAdIds = "";	  // Store adIDs that need renewedvar numAds = 0;			// Track number of ads copied// search stories for vehicles not added in current adfor (var i= 0; i < myStories.length; i++)	{	// find the adID pattern (#-######	// find ads that have 5 or 7 digits instead of 6 in case there are typos.	// the browse extension will alert user to the typo	patternMatch = myStories[i].contents.match(/\d+\-\d{5,7}/g);	if (patternMatch != null)	{		// Check the vehicle ID found does not match the current adID (is not a new ad)		for(var j= 0; j < patternMatch.length; j++)		{			if (patternMatch[j].match(currentAdId) == null)			{				// copy vehicle ID to string and add a space				renewAdIds += patternMatch[j];				renewAdIds += " ";				numAds++;			}		}	}}if (numAds > 0){	/ remove space at end of string	renewAdIds = renewAdIds.slice(0, renewAdIds.length -1); /		// Must create textbox in document to copy text to clipboard, then delete the textbox	var myTextBox = myDocument.pages[0].textFrames.add({geometricBounds:[0, -18, 10, -1]});	myTextBox.contents = renewAdIds;	myTextBox.parentStory.texts[0].select();	app.copy()	myTextBox.remove();		// Tell user how many ads were copied	alert ("Copied " + numAds + " ads to the clipboard.");}// Alert user if no ads were found to renewelse	alert("No ads to renew.");	